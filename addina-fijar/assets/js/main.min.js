/*
 * Maumantenan
 * https://maumantenan.com
 * Digital Wedding Invitation
 * Copyright (c) 2020-2021
 */
// Data
    const datePublishStart = new Date(2022, 3-1, 19, 0, 0, 0)
    const datePublishEnd = new Date(2023, 8-1, 18, 0, 0, 0)

    const md5security = 'addina-fijar security'
    const md5account = 'addina-fijar account'
    // https://www.md5hashgenerator.com/
    // const string = https://maumantenan.com/addina-fijar/
    const md5 = 'fa89854b145eac8617ac42ae45355dba'
    // const sha1 = '09c8e707aba7d3e04fbc3241b572ea597363cd53'

    // let shUrl = 'https://docs.google.com/spreadsheets/d/1vyQQXtnMjm1boXukIGqh0Mn1LmW2vPBOSqwYzljrjTI/gviz/tq?tqx=out:csv&sheet='
    //  gsStart = 'https://script.google.com/macros/s/'
    //  gsEnd = '/exec'
    //  urlBingkisan = gsStart + 'AKfycbxh8jDyyYT_5k-HZ88U286SIJ0FsnWwfwvQ1n85d37BkIW1trnat-Sfgjja300LE2Vo' + gsEnd
    //  urlKehadiran = gsStart + 'AKfycbxv3nQJOt6QsKTc16-XQqZbxawbaIb5Hc8HVn3EkZbcu1cOnkrgorvTaegJZom1ONrl' + gsEnd
    //  urlUcapan = gsStart + 'AKfycbymdUoyMXz2kQsP5rVEQKxqbFWtL0UDqtQ5pD6AlNzXmFk7bFBBDSnS9jp4yOOxJ6VQ' + gsEnd
    const shUrl = atob('aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvMXZ5UVFYdG5Nam0xYm9YdWtJR3FoME1uMUxtVzJ2UEJPU3F3WXpsanJqVEkvZ3Zpei90cT90cXg9b3V0OmNzdiZzaGVldD0=')
    const urlBingkisan = atob('aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J4aDhqRHl5WVRfNWstSFo4OFUyODZTSUowRnNuV3dmd3ZRMW44NWQzN0JrSVcxdHJuYXQtU2ZnamphMzAwTEUyVm8vZXhlYw==')
    const urlKehadiran = atob('aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J4djNuUUpPdDZRc0tUYzE2LVhRcVpieGF3YmFJYjVIYzhIVm4zRWtaYmN1MWNPbmtyZ29ydlRhZWdKWm9tMU9OcmwvZXhlYw==')
    const urlUcapan = atob('aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J5bWRVb3lNWHoya1FzUDVyVkVRS3hxYkZXdEwwVURxdFE1cEQ2QWxOelhtRms3YkZCQkRTblM5anA0eU9PeEo2VlEvZXhlYw==')

    const bulanAngka = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember']

    $.ajax({
        type: 'GET',
        url: shUrl + 'Undangan',
        success: function(data) {
            let undangan = $.csv.toArrays(data)
            $(undangan).each(function (i,list) {
                let acara1tanggal = list[1]
                    acara1jam = list[2]
                    acara2s = list[3].split(' ')
                    acara2 = acara2s[2] + ' ' + acara2s[3]
                    acara2tanggal = list[3]
                    acara2jam = list[4]
                    acara3s = list[5].split(' ')
                    acara3 = acara3s[2] + ' ' + acara3s[3]
                    acara3tanggal = list[5]
                    acara3jam = list[6]
                    acara2sesi1 = list[7]
                    acara2sesi2 = list[8]
                    acara2sesi3 = list[9]
                    acara2sesi4 = list[10]
                    acara2sesi5 = list[11]
                    acara3sesi1 = list[12]
                    acara3sesi2 = list[13]
                    acara3sesi3 = list[14]
                    acara3sesi4 = list[15]
                    acara3sesi5 = list[16]

                const event2 = String(acara2s[1]).padStart(2,'0') + ` &centerdot; ` + String(bulanAngka.indexOf(acara2s[2]) + 1).padStart(2,'0') + ` &centerdot; ` + acara2s[3]
                const event3 = String(acara3s[1]).padStart(2,'0') + ` &centerdot; ` + String(bulanAngka.indexOf(acara3s[2]) + 1).padStart(2,'0') + ` &centerdot; ` + acara3s[3]

                if ( $('body').data('event') == 1 ) {
                    $('.date-event').html(event2)
                } else if ( $('body').data('event') == 2 ) {
                    $('.date-event').html(event3)
                } else {
                    $('.date-event').addClass('d-none')
                }

                const event1title = `Akad Nikah`
                const event1date = acara1tanggal
                const event1time = `Pukul ` + acara1jam
                const event1place = `Bertempat di Kediaman Mempelai Putri<br>Dangkel RT 01 RW 01 Parakan, Temanggung`

                $('.title-event-1').html(event1title)
                $('.date-event-1').html(event1date)
                $('.time-event-1').html(event1time)
                $('.place-event-1').html(event1place)

                const event2title = `Resepsi Pernikahan`
                const event2intro = `Temanggung, ` + acara2
                const event2date = acara2tanggal
                const event2time = `Pukul ` + acara2jam
                const event2place = `Bertempat di Kediaman Mempelai Putri<br>Dangkel RT 01 RW 01 Parakan, Temanggung`
                const event2map = `https://goo.gl/maps/qfRJQ4ijPPQhikKc6`
                const event2session1 = `Pukul ` + acara2sesi1
                const event2session2 = `Pukul ` + acara2sesi2
                const event2session3 = `Pukul ` + acara2sesi3
                const event2session4 = `Pukul ` + acara2sesi4
                const event2session5 = `Pukul ` + acara2sesi5

                $('.title-event-2').html(event2title)
                $('.intro-event-2').html(event2intro)
                $('.date-event-2').html(event2date)
                $('.time-event-2').html(event2time)
                $('.place-event-2').html(event2place)
                $('.map-event-2').attr('href',event2map)
                $('#acara-2 .session-1').html(event2session1)
                $('#acara-2 .session-2').html(event2session2)
                $('#acara-2 .session-3').html(event2session3)
                $('#acara-2 .session-4').html(event2session4)
                $('#acara-2 .session-5').html(event2session5)

                const event3title = `Resepsi Ngunduh Mantu`
                const event3intro = `Bojonegoro, ` + acara3
                const event3date = acara3tanggal
                const event3time = `Pukul ` + acara3jam
                const event3place = `Bertempat di Kediaman Mempelai Putra<br>Sumberarum RT 018 RW 006 Ngraho, Bojonegoro`
                const event3map = `https://goo.gl/maps/`
                const event3session1 = `Pukul ` + acara3sesi1
                const event3session2 = `Pukul ` + acara3sesi2
                const event3session3 = `Pukul ` + acara3sesi3
                const event3session4 = `Pukul ` + acara3sesi4
                const event3session5 = `Pukul ` + acara3sesi5

                $('.title-event-3').html(event3title)
                $('.intro-event-3').html(event3intro)
                $('.date-event-3').html(event3date)
                $('.time-event-3').html(event3time)
                $('.place-event-3').html(event3place)
                $('.map-event-3').attr('href',event3map)
                $('#acara-3 .session-1').html(event3session1)
                $('#acara-3 .session-2').html(event3session2)
                $('#acara-3 .session-3').html(event3session3)
                $('#acara-3 .session-4').html(event3session4)
                $('#acara-3 .session-5').html(event3session5)

                const person1name = `Addina Azca Cahyasari`
                const person1nick = `Addina`
                const person1father = `Fauzan`
                const person1mother = `Siti Zulaihah`
                const person1place = `Dangkel RT 01 RW 01 Parakan, Temanggung`
                const person1gift1 = `-`
                const person1gift2 = `<b>` + person1name + `</b><br>-`

                $('.name-person-1').html(person1name)
                $('.nick-person-1').html(person1nick)
                $('.father-person-1').html(person1father)
                $('.mother-person-1').html(person1mother)
                $('.place-person-1').html(person1place)
                $('.gift1-person-1').html(person1gift1)
                $('.gift2-person-1').html(person1gift2)

                const person2name = `Mohammad Fijar Rahmanto`
                const person2nick = `Fijar`
                const person2father = `Mohamad Ali Susanto`
                const person2mother = `Aminatun`
                const person2place = `Sumberarum RT 018 RW 006 Ngraho, Bojonegoro`
                const person2gift1 = `-`
                const person2gift2 = `<b>` + person2name + `</b><br>-`

                $('.name-person-2').html(person2name)
                $('.nick-person-2').html(person2nick)
                $('.father-person-2').html(person2father)
                $('.mother-person-2').html(person2mother)
                $('.place-person-2').html(person2place)
                $('.gift1-person-2').html(person2gift1)
                $('.gift2-person-2').html(person2gift2)

                launch()
            })
        },
        error: function() {
            console.log('Maaf, silakan muat ulang halaman.')
        }
    })

// Launch
    function launch() {
        var preload = [
            'assets/img/qr-code.svg',
            'assets/img/floral.png',
            'https://maumantenan.com/tema/panggih/assets/img/pattern.png',
        ]
        var promises = []
        for (var i = 0; i < preload.length; i++) {
            (function(url, promise) {
                var img = new Image()
                img.onload = function() {
                    promise.resolve()
                }
                img.src = url
            })(preload[i], promises[i] = $.Deferred())
        }

        $.when.apply($, promises).done(function() {
            $('.preload').fadeOut()
            // loadInvitation()
            let checkURL = window.location.href
            if ( checkURL.indexOf('?') > -1 ) {
                let splitURL = checkURL.split('?')
                    decryptURL = atob(splitURL[1])
                if ( (decryptURL.indexOf('1!') > -1 || decryptURL.indexOf('2!') > -1) && (splitURL[1].substring(0,2) == 'MS' || splitURL[1].substring(0,2) == 'Mi') ) {
                    if ( localStorage.getItem(md5security) == md5 ) {
                        $('body').attr('data-from',localStorage.getItem(md5account))
                        loadInvitation()
                    } else {
                        if ( new Date() >= datePublishEnd ) {
                            publishEnd()
                        } else if ( new Date() >= datePublishStart && new Date() < datePublishEnd ) {
                            loadInvitation()
                        } else {
                            loadWelcome()
                        }
                    }
                } else {
                    publishEnd()
                }
            } else {
                publishEnd()
            }
        })
    }

// Guest
    function guestInvite(url) {
        let guest = url.split('?')

        if ( url.indexOf('?') > -1 ) {
            let detail = atob(guest[1])
            // let detail = guest[1]
            if ( (detail.indexOf('1!') > -1 || detail.indexOf('2!') > -1) && (guest[1].substring(0,2) == 'MS' || guest[1].substring(0,2) == 'Mi') ) {
                if ( detail.indexOf('@') > -1 && detail.indexOf(':') > -1 && detail.indexOf('#') > -1 ) {
                    let guest0 = detail.split('!')
                        guest1 = guest0[1].split('@')
                        guest2 = guest1[1].split(':')
                        guest3 = guest2[1].split('#')
                        guest4 = guest3[1]
                    let event = guest0[0]
                        name = guest1[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        address = guest2[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        from = guest3[0]
                        session = guest4[0]
                    $('body').attr('data-event',event).attr('data-from',from).attr('data-session',session)
                    $('.guest-name').html(name)
                    $('.guest-address').html(address)
                    $('#beriUcapan-2').each(function() {
                        $(this).val(name)
                        $(this).closest('.form-group').hide()
                    })
                } else if ( detail.indexOf('@') > -1 && detail.indexOf('#') > -1 ) {
                    let guest0 = detail.split('!')
                        guest1 = guest0[1].split('@')
                        guest2 = guest1[1].split('#')
                        guest3 = guest2[1]
                    let event = guest0[0]
                        name = guest1[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        address = guest2[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        session = guest3[0]
                    $('body').attr('data-event',event).attr('data-session',session)
                    $('.guest-name').html(name)
                    $('.guest-address').html(address)
                    $('#beriUcapan-2').each(function() {
                        $(this).val(name)
                        $(this).closest('.form-group').hide()
                    })
                } else if ( detail.indexOf('@') > -1 && detail.indexOf(':') > -1 ) {
                    let guest0 = detail.split('!')
                        guest1 = guest0[1].split('@')
                        guest2 = guest1[1].split(':')
                        guest3 = guest2[1]
                    let event = guest0[0]
                        name = guest1[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        address = guest2[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        from = guest3[0]
                    $('body').attr('data-event',event).attr('data-from',from)
                    $('.guest-name').html(name)
                    $('.guest-address').html(address)
                    $('#beriUcapan-2').each(function() {
                        $(this).val(name)
                        $(this).closest('.form-group').hide()
                    })
                } else if ( detail.indexOf(':') > -1 && detail.indexOf('#') > -1 ) {
                    let guest0 = detail.split('!')
                        guest1 = guest0[1].split(':')
                        guest2 = guest1[1].split('#')
                        guest3 = guest2[1]
                    let event = guest0[0]
                        name = guest1[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        from = guest2[0]
                        session = guest3[0]
                    $('body').attr('data-event',event).attr('data-from',from).attr('data-from',session)
                    $('.guest-name').html(name)
                    $('#beriUcapan-2').each(function() {
                        $(this).val(name)
                        $(this).closest('.form-group').hide()
                    })
                } else if ( detail.indexOf(':') > -1 ) {
                    let guest0 = detail.split('!')
                        guest1 = guest0[1].split(':')
                        guest2 = guest1[1]
                    let event = guest0[0]
                        name = guest1[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        from = guest2[0]
                    $('body').attr('data-event',event).attr('data-from',from)
                    $('.guest-name').html(name)
                    $('#beriUcapan-2').each(function() {
                        $(this).val(name)
                        $(this).closest('.form-group').hide()
                    })
                } else if ( detail.indexOf('#') > -1 ) {
                    let guest0 = detail.split('!')
                        guest1 = guest0[1].split('#')
                        guest2 = guest1[1]
                    let event = guest0[0]
                        name = guest1[0].split('+').join(' ').replace("%27","'").replace('%26','&')
                        session = guest2[0]
                    $('body').attr('data-event',event).attr('data-session',session)
                    $('.guest-name').html(name)
                    $('#beriUcapan-2').each(function() {
                        $(this).val(name)
                        $(this).closest('.form-group').hide()
                    })
                } else {
                    let guest0 = detail.split('!')
                        event = guest0[0]
                        name = guest0[1].split('+').join(' ').replace("%27","'").replace('%26','&')
                    $('body').attr('data-event',event)
                    $('.guest-name').html(name)
                    $('#beriUcapan-2').each(function() {
                        $(this).val(name)
                        $(this).closest('.form-group').hide()
                    })
                }
            }
        } else {
            $('.guest').addClass('d-none')
        }
    }
    guestInvite(window.location.href)

// Backsound
    let audio = document.createElement('audio')
        audio.src = 'https://maumantenan.com/tema/rawuh/assets/audio/audio.mp3'
        audio.volume = 1
        audio.autoPlay = false
        audio.preLoad = true
        audio.controls = true
        audio.loop = true

    $('.play-audio').click(function() {
        audio.play()
    })

// Open Invitation
    function detailInvitation() {
        let what = $('body').data('event')
            when = $('body').data('session')

        // if ( what == 0 ) {
        //  $('#acara-2').removeClass('d-none')
        //  $('#acara-3').removeClass('d-none')
        //  $('#qrcode-2').removeClass('d-none')
        //  $('#qrcode-3').removeClass('d-none')
        // } else if ( what == 1 ) {
        //  $('#acara-2').removeClass('d-none')
        //  $('#acara-3').addClass('d-none')
        //  $('#qrcode-2').removeClass('d-none')
        //  $('#qrcode-3').addClass('d-none')
        // } else if ( what == 2 ) {
        //  $('#acara-2').addClass('d-none')
        //  $('#acara-3').removeClass('d-none')
        //  $('#qrcode-2').addClass('d-none')
        //  $('#qrcode-3').removeClass('d-none')
        // } else {
        //  $('#acara-2').addClass('d-none')
        //  $('#acara-3').addClass('d-none')
        //  $('#qrcode-2').addClass('d-none')
        //  $('#qrcode-3').addClass('d-none')
        // }

        if ( when == 1 ) {
            $('[class^="time-event"]').addClass('d-none')
            $('.session-1').removeClass('d-none')
            $('.session-2').addClass('d-none')
            $('.session-3').addClass('d-none')
            $('.session-4').addClass('d-none')
            $('.session-5').addClass('d-none')
        } else if ( when == 2 ) {
            $('[class^="time-event"]').addClass('d-none')
            $('.session-1').addClass('d-none')
            $('.session-2').removeClass('d-none')
            $('.session-3').addClass('d-none')
            $('.session-4').addClass('d-none')
            $('.session-5').addClass('d-none')
        } else if ( when == 3 ) {
            $('[class^="time-event"]').addClass('d-none')
            $('.session-1').addClass('d-none')
            $('.session-2').addClass('d-none')
            $('.session-3').removeClass('d-none')
            $('.session-4').addClass('d-none')
            $('.session-5').addClass('d-none')
        } else if ( when == 4 ) {
            $('[class^="time-event"]').addClass('d-none')
            $('.session-1').addClass('d-none')
            $('.session-2').addClass('d-none')
            $('.session-3').addClass('d-none')
            $('.session-4').removeClass('d-none')
            $('.session-5').addClass('d-none')
        } else if ( when == 5 ) {
            $('[class^="time-event"]').addClass('d-none')
            $('.session-1').addClass('d-none')
            $('.session-2').addClass('d-none')
            $('.session-3').addClass('d-none')
            $('.session-4').addClass('d-none')
            $('.session-5').removeClass('d-none')
        } else {
            $('.session-1').addClass('d-none')
            $('.session-2').addClass('d-none')
            $('.session-3').addClass('d-none')
            $('.session-4').addClass('d-none')
            $('.session-5').addClass('d-none')
        }
    }

    function loadWelcome() {
        $('body').addClass('overflow-hidden')
        $('#welcome').modal('show')
    }

    function loadInvitation() {
        detailInvitation()

        $('body').addClass('overflow-hidden')
        $('#open').modal('show')

        setTimeout(() => {
            $('main').removeClass('opacity-0')
        },1000)

        // $('#covid').on('hide.bs.modal', function(e) {
        //  $('body').removeClass('overflow-hidden')
        // }).on('hidden.bs.modal', function(e) {
        //  $('body').addClass('ready')
        // })
    }

    function openInvitation(trigger,target) {
        $(trigger).closest('.modal').modal('hide')
        if ( audio.paused ) $('.backsound').click()
        if ( $('body:not(.ready)').length > 0 ) $(target).modal('show')
        if ( $('body.opened').length < 1 ) $('body').addClass('opened')
        $(trigger).blur()
        setTimeout(() => {
            $(target).modal('hide')
        },5000)
    }

// Countdown
    function publishStart() {
        if ( $('body.opened').length < 1 ) {
            $('#welcome').modal('hide')
            loadInvitation()
        }
    }
    function publishEnd() {
        $('#thanks').modal('show')
    }

    $('.countdown-publish').each(function() {
        $(this).countdown($.extend({
            until: datePublishStart,
            format: 'ODHMS',
            timezone: +7,
            onExpiry: publishStart,
        }, $.countdown.regionalOptions['id']))
    })

    let checkCDevent2 = setInterval(() => {
        if ( $('.date-event-2').text().length > 0 ) {
            let event2cd = $('.date-event-2').text().split(' ')
                event2ct = $('.time-event-2').text().split(' ')
                event2cts = event2ct[1].split(':')
            $('.countdown-event-2').each(function() {
                $(this).countdown($.extend({
                    until: new Date(event2cd[3], bulanAngka.indexOf(event2cd[2]), event2cd[1], Number(event2cts[0]), Number(event2cts[1]), 0),
                    format: 'ODHMS',
                    timezone: +7,
                }, $.countdown.regionalOptions['id']))
            })
            clearInterval(checkCDevent2)
        }
    },1000)

    let checkCDevent3 = setInterval(() => {
        if ( $('.date-event-3').text().length > 0 ) {
            let event3cd = $('.date-event-3').text().split(' ')
                event3ct = $('.time-event-3').text().split(' ')
                event3cts = event3ct[1].split(':')
            $('.countdown-event-3').each(function() {
                $(this).countdown($.extend({
                    until: new Date(event3cd[3], bulanAngka.indexOf(event3cd[2]), event3cd[1], Number(event3cts[0]), Number(event3cts[1]), 0),
                    format: 'ODHMS',
                    timezone: +7,
                }, $.countdown.regionalOptions['id']))
            })
            clearInterval(checkCDevent3)
        }
    },1000)

// Modal
    $('#open').on('shown.bs.modal',function(e) {
        setTimeout(function() {
            $('body').removeClass('overflow-hidden');
        },250);
    });

// AOS
    AOS.init({
        once: true
    });

// Countdown
    // $('.countdown').countdown($.extend({
    //  until: new Date(yyyy, mm-1, dd, 13, 0, 0),
    //  // until: new Date(2020, 12-1, 31, 23, 59, 0),
    //  format: 'ODHMS',
    //  timezone: +7,
    // }, $.countdown.regionalOptions['id']));

    // function finishCountdown() {
    //  $('#welcome').modal('hide');
    //  $('#open').modal('show');
    //  $('#open').on('shown.bs.modal', function() {
    //      $('body').addClass('modal-open');
    //  });
    // };

    // $('.countdown-publish').countdown($.extend({
    //  until: new Date(cddYY, cddMM-1, cddDD, cddH, cddM+1, cddS),
    //  // until: new Date(2021, 12-1, 31, 23, 59, 0),
    //  format: 'ODHMS',
    //  timezone: +7,
    //  onExpiry: finishCountdown,
    // }, $.countdown.regionalOptions['id']));

// Copy to clipboard
    // function copyToClipboard(element) {
    //  var temp = $('<textarea>');
    //      brRegex = /<br\s*[\/]?>/gi;
    //  $('body').append(temp);
    //  temp.val($(element).html().replace('<b>','').replace('</b>','').replace(brRegex, "\r\n")).select();
    //  document.execCommand('copy');
    //  temp.remove();

    //  $(element).closest('div').find('.btn-primary').toggleClass('btn-primary btn-success');
    //  $(element).closest('div').find('.btn-caption').toggleClass('d-flex d-none');
    //  setTimeout(function() {
    //      $(element).closest('div').find('.btn-success').toggleClass('btn-primary btn-success');
    //      $(element).closest('div').find('.btn-caption').toggleClass('d-flex d-none');
    //  }, 3000);
    // }

// Timeline
    // function timeline() {
    //  if ( document.querySelector('#tls') !== null ) {
    //      let remove = document.querySelector('#tls')
    //      remove.remove(remove)
    //  }
    //  let height = $('.timeline-item:last-child').height();
    //      heightMobileTop = 35;
    //      heightMobileBottom = height - heightMobileTop + 5;
    //      heightDesktopTop = 60;
    //      heightDesktopBottom = height - heightDesktopTop + 5;
    //  style = document.createElement('style');
    //  style.id = 'tls'
    //  style.innerHTML = `.timeline-item:first-child:after {height:` + heightMobileTop + `px} .timeline-item:last-child:after {height:` + heightMobileBottom + `px} @media (min-width: 768px) { .timeline-item:first-child:after {height:` + heightDesktopTop + `px} .timeline-item:last-child:after {height:` + heightDesktopBottom + `px} }`;
    //  document.querySelector('head').appendChild(style)
    // }
    // timeline()
    // $(window).resize(timeline)

// Congrats
    // if ( $('#ucapan').length > 0 ) {
    //  const monthsShort = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Ags', 'Sep', 'Okt', 'Nov', 'Des']

    //  const sheetStart = 'https://spreadsheets.google.com/feeds/list/'
    //  const sheetID = '1FOiCKpx-hE8qfIcNdGbuUBQykPFlBO8JfvtXNdraMGI'
    //  // const sheetTab = '/od6'
    //  const sheetEnd = '/public/values?alt=json'

    //  function showUcapan() {
    //      $('#reloadUcapan').remove()
    //      $(`<div class="bg-theme-1 text-white p-2 rounded-circle cursor-pointer" id="loadingUcapan">
    //          <div class="spinner-border" role="status" style="width:20px;height:20px;font-size:10px;margin:2px;">
    //              <span class="sr-only">Loading...</span>
    //          </div>
    //      </div>`).prependTo('#dataUcapan')

    //      let sheetTab = '/1'
    //          source = sheetStart + sheetID + sheetTab + sheetEnd

    //      $.getJSON(source, function() {
    //          console.log('Success!')
    //      })

    //      .done(function(data) { 
    //          if (data.feed.entry.length > 0) {
    //              $.each( data.feed.entry, function( i, item ) {
    //                  let $tanggal = item.gsx$tanggal.$t
    //                      splitTanggal = $tanggal.split('/')
    //                      $tanggal = Number(splitTanggal[0]) + ' ' + monthsShort[Number(splitTanggal[1])-1] + ' ' + splitTanggal[2]
    //                      $nama = item.gsx$nama.$t
    //                      $ucapan = item.gsx$ucapan.$t

    //                  $(`<div class="card mx-3 border-0 shadow bg-transparent d-none rounded">
    //                      <div class="card-body bg-overlay rounded">
    //                          <p class="mb-0">` + $ucapan + `</p>
    //                          <div class="font-weight-bold color-theme text-uppercase mt-2 mt-md-1">` + $nama + `</div>
    //                          <small class="opacity-5">` + $tanggal + `</small>
    //                      </div>
    //                  </div>`).prependTo('#dataUcapan')
    //              })
    //              $('#loadingUcapan').remove()
    //              $('#reloadUcapan').remove()
    //              $('#dataUcapan').next().removeClass('d-none')
    //              $('#dataUcapan .card:nth-child(1)').removeClass('d-none')
    //              $('#dataUcapan .card:nth-child(2)').removeClass('d-none')
    //              $('#dataUcapan .card:nth-child(3)').removeClass('d-none')
    //          } else {
    //              console.log('Null!')
    //          }
    //      })

    //      .fail(function() {
    //          console.error('Error!')
    //          $('#loadingUcapan').remove()
    //          $(`<div class="bg-theme-1 text-white p-2 rounded-circle cursor-pointer" onclick="showUcapan()" id="reloadUcapan">
    //              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
    //                  <path d="M2 12C2 16.97 6.03 21 11 21C13.39 21 15.68 20.06 17.4 18.4L15.9 16.9C14.63 18.25 12.86 19 11 19C4.76 19 1.64 11.46 6.05 7.05C10.46 2.64 18 5.77 18 12H15L19 16H19.1L23 12H20C20 7.03 15.97 3 11 3C6.03 3 2 7.03 2 12Z"/>
    //              </svg>
    //          </div>`).prependTo('#dataUcapan')
    //      })

    //      $('#dataUcapan').each(function() {
    //          let list = $(this)
    //          list.next().on('click',function() {
    //              let button = $(this)
    //                  hidden = list.find('.d-none')
    //                  numb = 3
    //                  slice = Array.from(hidden).slice(0, numb)
    //              slice.forEach(element => {
    //                  element.classList.remove('d-none')
    //              })
    //              if (hidden.length <= numb) {
    //                  button.addClass('d-none')
    //              }
    //          })
    //      })
    //  }
    //  // showUcapan()

    //  function slideUcapan() {
    //      const slideUcapan = document.querySelector('#ucapan .overflow-auto')
    //      let isDown = false
    //      let startX
    //      let scrollLeft

    //      slideUcapan.addEventListener('mousedown', (e) => {
    //          isDown = true
    //          slideUcapan.classList.add('active')
    //          startX = e.pageX - slideUcapan.offsetLeft
    //          scrollLeft = slideUcapan.scrollLeft
    //      })
    //      slideUcapan.addEventListener('mouseleave', () => {
    //          isDown = false
    //          slideUcapan.classList.remove('active')
    //      })
    //      slideUcapan.addEventListener('mouseup', () => {
    //          isDown = false
    //          slideUcapan.classList.remove('active')
    //      })
    //      slideUcapan.addEventListener('mousemove', (e) => {
    //          if(!isDown) return
    //          e.preventDefault()
    //          const x = e.pageX - slideUcapan.offsetLeft
    //          const walk = (x - startX) * 3
    //          slideUcapan.scrollLeft = scrollLeft - walk
    //      })
    //  }
    //  // slideUcapan()

    //  const gsStart = 'https://script.google.com/macros/s/'
    //  const gsEnd = '/exec'

    //  var gsUcapan = 'AKfycbxyOWjPIab8UPOl5dCwDiPISVbQ_aRuNmk7-t6PtgXqUBLEKMKEvzQdb6z0lQJOv7Y'
    //      gsKehadiran = 'AKfycbwv1xc5dfgQhQss78RcP8NmKLIOS9jehLb2NO4T4xpbhXYTxWfFN8cKDctbwWGCcWwZ'
    //      gsBingkisan = 'AKfycbzO3ZxVkhP04RbsdFW-NVXEBL3CiE_gRfo207IR66GX262OCYawEtRFU4TMT-Yc-R2O'

    //  var urlUcapan = gsStart + gsUcapan + gsEnd
    //      formUcapan = document.forms['beriUcapan']

    //  formUcapan.addEventListener('submit', e => {
    //      e.preventDefault()
    //      $('.form-gsheet .loading').addClass('show')
    //      fetch(urlUcapan, { method: 'post', body: new FormData(formUcapan)})
    //      .then(response => {
    //          console.log('Success!', response)
    //          let sender  = formUcapan.querySelector('input').value
    //              message = formUcapan.querySelector('textarea').value
    //              today   = new Date()
    //              stamp   = today.getDate() + ' ' + monthsShort[today.getMonth()] + ' ' + today.getFullYear() + ' - Baru Saja'
    //          $(`<div class="card mx-3 border-0 shadow bg-transparent rounded">
    //              <div class="card-body bg-overlay rounded">
    //                  <p class="mb-0">` + message + `</p>
    //                  <div class="font-weight-bold color-theme text-uppercase mt-2 mt-md-1">` + sender + `</div>
    //                  <small class="opacity-5">` + stamp + `</small>
    //              </div>
    //          </div>`).prependTo('#dataUcapan')
    //          $('.form-gsheet .loading').removeClass('show')
    //          formUcapan.reset()
    //      })
    //      .catch(error => {
    //          $('.form-gsheet .loading').removeClass('show')
    //          console.error('Error!', error.message)
    //      })
    //  })

    //  formUcapan.querySelector('#kirimWA').addEventListener('click', e => {
    //      let sender  = formUcapan.querySelector('input').value
    //          message = formUcapan.querySelector('textarea').value
    //      if ( sender.length < 1 || message.length < 1 ) {
    //          formUcapan.querySelector('[type="submit"]').click()
    //      } else {
    //          $('#kirimUcapan').modal('show')
    //      }
    //      $('#kirimUcapan [data-phone]').click(function() {
    //          let phone = $(this).data('phone')
    //              url = 'https://wa.me/' + phone + '?text=' + encodeURIComponent(message) + '%0A%0A-%20' + sender
    //          window.open(url,'_blank')
    //      })
    //  })
    // }

// Starter Pack
    window.onbeforeunload = function() {
        $('body').remove()
        $(window).scrollTop(0)
    }

    $(document).on('contextmenu',function() {
        return false
    })

    $(document).keydown(function(e) {
        let form = e.target.tagName.toLowerCase()
        if ( form != 'input' && form != 'textarea' ) {
            if (e.ctrlKey || e.metaKey) {
                if (e.keyCode == 65 || e.keyCode == 83) {
                    return false
                }
            }
        }
    })
